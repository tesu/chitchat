<html>
	<head>
		<title>SHITCHAT - THE SHITTIEST CHAT CLIENT EVER</title>
		<script src="/socket.io/socket.io.js"></script>
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
		<link href='http://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>
		<link href='styles.css' rel='stylesheet' type='text/css'>
	</head>
	<body style="">
		<script>
			var socket = io.connect();

			socket.on('message', function(data){
				var time = new Date();
				var timestamp = '[';
				if (time.getHours() < 10) {
					timestamp += '0';
				}
				timestamp += time.getHours() + ':'
				if (time.getMinutes() < 10) {
					timestamp += '0';
				}
				timestamp += time.getMinutes() + ':'
				if (time.getSeconds() < 10) {
					timestamp += '0';
				}
				timestamp += time.getSeconds() + '] ';
				$('#fuckoff').val($('#fuckoff').val() + timestamp + data.message + "\n");
				$('#fuckoff').scrollTop($('#fuckoff')[0].scrollHeight);
			});

			socket.on('user_count', function(data){
				$('#usersonline').html(data.message);
			});

			$(document).ready(function(){
				$('#text').keypress(function(e){
					if(e.charCode == 13 || e.keycode == 13 || e.which == 13) {
						if ($('#text').val().replace(/\n|\r/g, '') == "/clear") {
							$('#fuckoff').val('');
							$('#text').val('');
							return;
						}
						if ($('#text').val().replace(/\n|\r/g, '') == "/disconnect") {
							socket.disconnect();
							return;
						}


						socket.emit('client_response', {'message': $('#text').val().replace(/\n|\r/g, '')});
						$('#text').val('');
					}
				})
			})
		</script>
		<h1>welcome to shitchat - the shittiest chat client ever</h1>
		<textarea id="fuckoff" disabled="disabled"></textarea>

		<div id="footer">
			<textarea id="text" rows="1"></textarea>
			<span id="span"><span id="usersonline"></span> users online</span>
		</div>
	</body>
</html>